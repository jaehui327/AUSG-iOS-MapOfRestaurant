# AUSG-iOS-MapOfRestaurant ğŸ

## iOS ì„œë¹„ìŠ¤ì— ì—°ê²°í•˜ê¸°

### í•¸ì¦ˆì˜¨ ì‹œê°„ì„ ê³ ë ¤í•˜ì—¬ ëŒ€ë¶€ë¶„ì˜ ê¸°ëŠ¥ì´ êµ¬í˜„ë˜ì–´ ìˆëŠ” Base í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ì–´ ë‘ì—ˆìŠµë‹ˆë‹¤.
### í•¸ì¦ˆì˜¨ì€ ì´ Base í”„ë¡œì íŠ¸ë¥¼ ìˆ˜ì •í•´ ë‚˜ê°€ëŠ” í˜•ì‹ìœ¼ë¡œ ì§„í–‰ë©ë‹ˆë‹¤.



### [ì£¼ìš” ê¸°ëŠ¥]

#### ë³„ì ì— ë”°ë¼ ë§ˆì»¤ì˜ ìƒ‰ìƒì˜ ë³€í™”ë¥¼ ì£¼ì–´ ë§›ì§‘ì„ êµ¬ë¶„í•  ìˆ˜ ìˆëŠ” ë§›ì§‘ ì§€ë„ì…ë‹ˆë‹¤. ğŸ˜†ğŸ´ğŸ”

<p align="center">
<img src="../images/iOS_guide/2.png" width="400"><br>
</p>

#### ì˜¤ë¥¸ìª½ í•˜ë‹¨ì˜ `+` ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì¥ì†Œë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<p align="center">
<img src="../images/iOS_guide/3.png" width="400"><br>
</p>

#### ì¥ì†Œë¥¼ ì¶”ê°€í•˜ë©´ ì§€ë„ì— ìœ„ì¹˜ê°€ ëœ¹ë‹ˆë‹¤. 

#### ë§ˆì»¤ë¥¼ íƒ­í•˜ë©´ ë‚˜ì˜¤ëŠ” windowë¥¼ ë‹¤ì‹œ íƒ­í•˜ë©´ ìƒì„¸ ì •ë³´ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<p align="center">
<img src="../images/iOS_guide/4.png" width="400"><br>
</p>


#### ì•„ì§ì€ ë³„ì  ì •ë³´ê°€ ì—†ëŠ” ìƒíƒœì…ë‹ˆë‹¤! ë„£ì–´ë³¼ê¹Œìš”?

<p align="center">
<img src="../images/iOS_guide/5.png" width="400"><br>
</p>

#### ë³„ì„ íƒ­í•˜ì—¬ ë³„ì ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! 4ì ì„ ì„ íƒí•´ë³¼ê²Œìš”!

<p align="center">
<img src="../images/iOS_guide/6.png" width="400"><br>
</p>

#### ì§ ! ë…¸ë€ìƒ‰ ë§ˆì»¤ë¡œ ë°”ë€Œì—ˆìŠµë‹ˆë‹¤. ğŸ˜

<p align="center">
<img src="../images/iOS_guide/7.png" width="400"><br>
</p>

#### ìƒì„¸ í™”ë©´ì— ë³„ì ë„ ì•Œë§ê²Œ ë³€í™”ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<p align="center">
<img src="../images/iOS_guide/8.png" width="400"><br>
</p>

## iOS í”„ë¡œì íŠ¸ íŒŒì¼ ë°›ê¸°

https://github.com/jaehui327/AUSG-iOS-MapOfRestaurant

ìœ„ ë§í¬ì— ì ‘ì†í•˜ì—¬ `Download ZIP`ì„ í´ë¦­í•´ì£¼ì„¸ìš”.

![](../images/iOS_guide/9.png)

ì••ì¶•ì„ í’€ê³  í”„ë¡œì íŠ¸ í´ë”ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.

![](../images/iOS_guide/10.png)

`í„°ë¯¸ë„`ë¡œ ì´ë™í•˜ì—¬ `í”„ë¡œì íŠ¸ í´ë”`ì—ì„œ `pod install` í•´ì¤ë‹ˆë‹¤.

```
$ pod install
```

![](../images/iOS_guide/11.png)

ê·¸ë¦¬ê³  ë‚˜ì„œ `workspace` íŒŒì¼ë¡œ ì—´ì–´ì£¼ì„¸ìš”.

![](../images/iOS_guide/12.png)



ì¼ë‹¨ ê·¸ëƒ¥ ì‹¤í–‰ ì‹œì¼œë³¼ê¹Œìš”?

![](../images/iOS_guide/13.png)

í˜„ì¬ ìœ„ì¹˜ë§Œ ì°íˆëŠ” ì§€ë„ì˜ ëª¨ìŠµì…ë‹ˆë‹¤.

<p align="center">
<img src="../images/iOS_guide/14.png" width="400"><br>
</p>

ìœ„ì—ì„œ ë´¤ë˜ ëª¨ìŠµì²˜ëŸ¼ ìˆ˜ì •í•´ë´…ì‹œë‹¤!!

## í”„ë¡œì íŠ¸ íŒŒì¼ ìˆ˜ì •

### 1. Location.swift
```swift
struct LocationList: Codable {
    /* ì¶”ê°€ ë¶€ë¶„ ì‹œì‘ */
    struct CustomData: Codable {
        let rating: Double?
    }
    let id: Int
    let longitude: Double?
    let latitude: Double?
    let name: String?
    let description: String?
    let address: String?
    let rating: CustomData?
    /* ì¶”ê°€ ë¶€ë¶„ ë */
}
```



### 2. LocationNetworkModel.swift
```swift
import Alamofire

struct LocationService {
    /* ì¶”ê°€ ë¶€ë¶„ ì‹œì‘ */
    // ì£¼ì†Œ ë“±ë¡í•˜ê¸°
    // POST /locations
    func postLocationInformation(longitude: Double, latitude: Double, name: String, description: String, address: String, completionHandler: @escaping (LocationList) -> Void) {
        let params = ["longitude" : longitude,
                      "latitude" : latitude,
                      "name" : name,
                      "description" : description,
                      "address" : address] as [String : Any]
        Alamofire.request("\(SERVER_URL)/locations",
            method: .post,
            parameters: params,
            encoding: JSONEncoding.default,
            headers: nil).responseData { dataResponse in
                switch dataResponse.result {
                case .success(let data):
                    do {
                        let locationList = try JSONDecoder().decode(LocationList.self, from: data)
                        completionHandler(locationList)
                    } catch {
                        print("Got and error: \(error)")
                    }
                case .failure(let error):
                    print(error.localizedDescription)
                }
        }
    }
    
    // ëª¨ë“  ì£¼ì†Œ ê°€ì ¸ì˜¤ê¸°
    // GET /locations
    func getLocationList(completionHandler: @escaping ([LocationList]) -> Void) {
        Alamofire.request("\(SERVER_URL)/locations",
            method: .get,
            parameters: nil,
            headers: nil).responseData{ dataResponse in
                switch dataResponse.result {
                case .success(let data):
                    do {
                        let locationLists = try JSONDecoder().decode([LocationList].self, from: data)
                        completionHandler(locationLists)
                    } catch {
                        print("Got and error: \(error)")
                }
                case .failure(let error):
                    print(error.localizedDescription)
                }
        }
    }
    /* ì¶”ê°€ ë¶€ë¶„ ë */
}

```



### 3. RatingNetworkModel.swift

```swift
import Alamofire

struct RatingService {
    /* ì¶”ê°€ ë¶€ë¶„ ì‹œì‘ */
    // ë³„ì  ë“±ë¡í•˜ê¸°
    // POST /rating
    func postRatingInformation(rating: Int, locationId: Int, completionHandler: @escaping (RatingInformation) -> Void) {
        let params = ["rating" : rating,
                      "locationId" : locationId] as [String : Any]
        Alamofire.request("\(SERVER_URL)/ratings",
            method: .post,
            parameters: params,
            encoding: JSONEncoding.default,
            headers: nil).responseData { dataResponse in
                switch dataResponse.result {
                case .success(let data):
                    do {
                        let ratingInformation = try JSONDecoder().decode(RatingInformation.self, from: data)
                        completionHandler(ratingInformation)
                    } catch {
                        print("Got and error: \(error)")
                    }
                case .failure(let error):
                    print(error.localizedDescription)
                }
        }
    }
    /* ì¶”ê°€ ë¶€ë¶„ ë */
}
```



### 4. GoogleMapViewController.swift

#### 1) func getLocation()

```swift
func getLocation() {
/* ì¶”ê°€ ë¶€ë¶„ ì‹œì‘ */
        // ì¥ì†Œ ê°€ì ¸ì˜¤ê¸° - get location list
        locationModel?.getLocationList{ locationLists in
            // self.lactionListsì— ëŒ€ì…
            self.locationLists = locationLists
            
            // ì‘ë‹µ log
            print("getLocationList success!")
            
            self.marker.removeAll()
            self.ratingArray.removeAll()
            self.ratingArray.removeAll()
            
            for location in self.locationLists {
                let index = location.id - 1
                self.marker.insert(GMSMarker(), at: index)
                self.marker[index].position = CLLocationCoordinate2D(latitude: location.latitude ?? 0.0, longitude: location.longitude ?? 0.0)
                self.ratingArray.insert(location.rating?.rating ?? 0.0, at: index)
                self.setMakerColor(rating: self.ratingArray[index], index: index)
                self.marker[index].title = location.name
                self.marker[index].snippet = location.description
                self.marker[index].map = self.mapView
                
                self.marker[index].zIndex = Int32(index)
            }
        }
/* ì¶”ê°€ ë¶€ë¶„ ë */
    }
```

#### 2)  func mapView(_ mapView: GMSMapView, didTapInfoWindowOf marker: GMSMarker)

```swift
func mapView(_ mapView: GMSMapView, didTapInfoWindowOf marker: GMSMarker) {
        let storyboard = UIStoryboard(name: "Main", bundle: nil)
        guard let viewController: DetailViewController = storyboard.instantiateViewController(withIdentifier: "Detail") as? DetailViewController else { return }
        
        let id = Int(marker.zIndex) + 1
        viewController.locationId = id
        viewController.name = marker.title ?? ""
        viewController.rating = ratingArray[id - 1]
        viewController.address = locationLists[id - 1].address ?? "" /* ì£¼ì„ í•´ì œ */
        
        self.present(viewController, animated: true)
    }
```



### 5. SetStarViewController.swift

```swift
@IBAction func sendRating(_ sender: Any) {
/* ì¶”ê°€ ë¶€ë¶„ ì‹œì‘ */
        ratingModel?.postRatingInformation(rating: starNum, locationId: locationId) { RatingInformation in
            // ì „ì†¡ ì™„ë£Œ log
            print("postRatingInformation success - locationId: \(self.locationId), starNum: \(self.starNum)")
            self.dismiss(animated: true, completion: nil)
        }
/* ì¶”ê°€ ë¶€ë¶„ ë */
    }
```



### 6. AddRestaurantViewController.swift

```swift
@IBAction func tappedSend(_ sender: Any) {
/* ì¶”ê°€ ë¶€ë¶„ ì‹œì‘ */
        // textfield ê°’ Doubleí˜•ìœ¼ë¡œ ë³€í™˜
        guard let longitude = NumberFormatter().number(from: longitudeTextField.text ?? "")?.doubleValue else { return }
        guard let latitude = NumberFormatter().number(from: latitudeTextField.text ?? "")?.doubleValue else { return }
        
        // network
        locaionModel?.postLocationInformation(longitude: longitude, latitude: latitude, name: nameTextField.text ?? "", description: descriptionTextField.text ?? "", address: addressTextField.text ?? "") { locationList in
            // ì „ì†¡ ì™„ë£Œ log
            print("postLocationIformation success - longitude : \(longitude), latitude: \(latitude), name: \(String(describing: self.nameTextField.text)), description: \(String(describing: self.descriptionTextField.text)), address: \(String(describing: self.addressTextField.text))")
            self.navigationController?.popViewController(animated: true)
        }
/* ì¶”ê°€ ë¶€ë¶„ ë */
    }
```

### 7. ServerSting.swift

```swift
import Foundation

let SERVER_URL = "[elastic beanstalk url]"

```



## TEST

ì§ ! ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‘ğŸ‘ğŸ‘

<p align="center">
<img src="../images/iOS_guide/15.png" width="400"><br>
</p>

ë§›ì§‘ ì§€ë„ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ì¥ì†Œ ë“±ë¡ì´ í•„ìš”í•©ë‹ˆë‹¤. 

ë”°ë¼ì„œ í¸í•˜ê²Œ ì…ë ¥í•˜ì‹¤ ìˆ˜ ìˆë„ë¡ ëª‡ ê°œì˜ ì¥ì†Œë¥¼ ì œê³µí•˜ë ¤ê³  í•©ë‹ˆë‹¤.



ì•„ë˜ ì§€ë„ëŠ” AUSGì—ì„œ ê³µìœ í•˜ëŠ” ë§›ì§‘ ì§€ë„ì…ë‹ˆë‹¤. ğŸ˜Š (ëª‡ êµ°ë° ì—†ì§€ë§Œ.. ë³¸ì˜ ì•„ë‹ˆê²Œ ë§¥ì£¼ì§‘ ìœ„ì£¼.. ã…ã…ã…)

![](../images/iOS_guide/1.png)

ì´ ì§€ë„ì— ìˆëŠ” ì¥ì†Œì— ëŒ€í•œ ì •ë³´ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.



- í…€ë¸”ëŸ¬ë¹„ì–´ ì—­ì‚¼ì§ì˜ì 
  - longtitude : 127.03474
  - latitude : 37.4987
  - name : tumbler beer
  - description : beer
  - address : Gangnam-gu, Seoul



- ë°”ìŠ¤ë²„ê±° ì—­ì‚¼ì 
  - longtitude : 127.03582
  - latitude : 37.49962
  - name : basburger
  - description : burger
  - address : Gangnam-gu, Seoul



- ìƒí™œë§¥ì£¼ ì—­ì‚¼ì 
  - longtitude : 127.03929
  - latitude : 37.50318
  - name : dailybeer
  - description : beer
  - address : Gangnam-gu, Seoul



- ì‹ ì´Œí™©ì†Œê³±ì°½ ê°•ë‚¨ì—­
  - longtitude : 127.02715
  - latitude : 37.50181
  - name : kshgop
  - description : gopchang
  - address : Gangnam-gu, Seoul



ì´ ì •ë³´ ì™¸ì—ë„ 
  - longtitude : 127.02 ~ 06
  - latitude : 37.47 ~ 51

ì‚¬ì´ ê°’ìœ¼ë¡œ ì¥ì†Œë¥¼ ë„£ì–´ ì£¼ì‹œë©´ í˜„ì¬ ìœ„ì¹˜ ê·¼ë°©ìœ¼ë¡œ ì„¤ì • ê°€ëŠ¥í•©ë‹ˆë‹¤. â˜ºï¸



## ëª¨ë‘ ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤. ì•ìœ¼ë¡œë„ ì¬ë°ŒëŠ” ê°œë°œë˜ì„¸ìš”! ğŸ™ğŸ˜‰

---

- [ì‚­ì œ ê°€ì´ë“œ](https://github.com/jaehui327/AUSG-iOS-MapOfRestaurant/blob/master/guide/delete_guide.md)
